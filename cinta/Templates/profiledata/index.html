{% load static %}

<html>
    <title>Profiledata</title>
    <head>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    </head>
    <body>
<div class="make-center">
    <div class="panel panel-default">
        <div class="panel-body">Edit User Profile <button id="edit-form">Click me</button></div>
      </div>
        <form id="profile_form" >
        {% for data in alldata %}
        {% csrf_token %}

        <div class="row">
  
            <input type="hidden" value={{ data.id}}  name="id">
            <div class="col-md-6">

                <div class="form-group">
                    <label for="Name">Name:</label>
                    
                    <input type="text" class="form-control loop" name="name" value={{data.Name}} disabled="true">
                <img src="https://images.vexels.com/media/users/3/157932/isolated/preview/951a617272553f49e75548e212ed947f-curved-check-mark-icon-by-vexels.png" width="50px" height="60px" style="display:none" class="show_check"> 
                </div>
        
                 
                <div class="form-group">
                    <label for="Age">Age:</label>
                    <input type="text" class="form-control loop" name="age" value={{data.Age}} disabled="true">
                    <img src="https://images.vexels.com/media/users/3/157932/isolated/preview/951a617272553f49e75548e212ed947f-curved-check-mark-icon-by-vexels.png" width="50px" height="60px" style="display:none" class="show_check"> 
  
                </div>
        
              
        
                <div class="form-group">
                    <label for="skills">Skills:</label>
                    <select class="js-example-basic-single loop form-control" name="skills[]" multiple disabled="disabled">
                        {% for skill in skills %}

                        <option value="{{ skill.id }}">{{ skill.title }}</option>
                            
                        {% endfor %}
                        
                      

                      </select>
                      <img src="https://images.vexels.com/media/users/3/157932/isolated/preview/951a617272553f49e75548e212ed947f-curved-check-mark-icon-by-vexels.png" width="50px" height="60px" style="display:none" class="show_check"> 

                </div>
        
                {% endfor %}
                
                <img src="{{alluploader_data.Images.url}}"  height="10%" width="10%" class="img-thumbnail" alt="profile photo">
                
                <!-- <h2 class="text-center" >{{alluploader_data.caption}}</h2> -->
                
                <a href="myupload" class="btn btn-info" role="button">Upload pics here</a>

                <input class="btn btn-submit loop" type="submit" disabled="true">
            </div>


        </div> 
        

    </form>
    </div>

    <script>
        
$(document).ready(function() {
    $('.js-example-basic-single').select2();

    let ids=JSON.parse('{{ user_skills_ids }}');
    $('.js-example-basic-single').val(ids).trigger('change');

});


     function disableCommon(){
        $( ".loop" ).each(function( index ) {
     
     if($(this).attr("disabled")=="disabled"){
      $(this).attr("disabled",false);
     }else{
      $(this).attr("disabled","disabled");
     }

  console.log($(this).attr("disabled"));

  });
     }
     $("#edit-form").click(function(e){
         e.preventDefault();
          
         disableCommon();
        
     })

     $("#profile_form").submit(function(e){
    
        e.preventDefault();
        $.ajax({
          type: "POST",
          url: "{% url 'save' %}",
          data: $(this).serialize(),
          success: function(data) {

         

},

error: function(xhr, status, error){

    $(".show_check").show();
           setTimeout(function(){
            $(".show_check").hide();
            disableCommon();
           },1000)

}
});

     });


        </script>
    </body>
</html>